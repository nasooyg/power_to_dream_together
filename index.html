<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¢Œí‘œ ê·¸ë˜í”„ ê³„ì‚°ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9fafb;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
            background: white;
        }

        h1 {
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 2rem;
            color: #1f2937;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        @media (min-width: 1024px) {
            .grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .input-section {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        h2 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
        }

        .btn {
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-purple {
            background-color: #e9d5ff;
            color: #7c3aed;
        }

        .btn-purple:hover {
            background-color: #ddd6fe;
        }

        .btn-blue {
            background-color: #dbeafe;
            color: #2563eb;
        }

        .btn-blue:hover {
            background-color: #bfdbfe;
        }

        .btn-primary {
            background-color: #2563eb;
            color: white;
        }

        .btn-primary:hover {
            background-color: #1d4ed8;
        }

        .btn-red {
            background-color: #dc2626;
            color: white;
        }

        .btn-red:hover {
            background-color: #b91c1c;
        }

        .btn-green {
            background-color: #16a34a;
            color: white;
        }

        .btn-green:hover {
            background-color: #15803d;
        }

        .btn-gray {
            background-color: #e5e7eb;
            color: #374151;
        }

        .btn-gray:hover {
            background-color: #d1d5db;
        }

        .btn-disabled {
            background-color: #f3f4f6;
            color: #9ca3af;
            cursor: not-allowed;
        }

        .btn-full {
            width: 100%;
            justify-content: center;
        }

        .point-input {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .point-number {
            width: 32px;
            font-size: 0.875rem;
            color: #6b7280;
        }

        input[type="number"] {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 0.875rem;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 1px #2563eb;
        }

        .delete-btn {
            padding: 4px;
            background: none;
            border: none;
            color: #dc2626;
            cursor: pointer;
            border-radius: 4px;
        }

        .delete-btn:hover {
            background-color: #fef2f2;
        }

        .predict-section {
            border-top: 1px solid #e5e7eb;
            padding-top: 1rem;
            margin-top: 1rem;
        }

        .radio-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .predict-input-group {
            display: flex;
            gap: 0.5rem;
        }

        .predict-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
        }

        .result-box {
            padding: 12px;
            background-color: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-radius: 4px;
            color: #15803d;
            margin-top: 0.5rem;
        }

        .graph-section {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .graph-container {
            display: flex;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .empty-graph {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 600px;
            height: 450px;
            background-color: #f9fafb;
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            text-align: center;
            color: #6b7280;
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            font-size: 0.875rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .legend-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        .legend-line {
            width: 16px;
            height: 4px;
        }

        .svg-graph {
            max-width: 600px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background: white;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ì¢Œí‘œ ê·¸ë˜í”„ ê³„ì‚°ê¸°</h1>
        
        <div class="grid">
            <!-- ì…ë ¥ ì„¹ì…˜ -->
            <div class="input-section">
                <div>
                    <div class="section-header">
                        <h2>ì¢Œí‘œ ì…ë ¥</h2>
                        <button class="btn btn-purple" onclick="loadSampleData()">
                            <span>ğŸ“Š</span>
                            <span>ì˜ˆì‹œ ë°ì´í„°</span>
                        </button>
                    </div>
                    <div id="pointsContainer">
                        <!-- í¬ì¸íŠ¸ ì…ë ¥ í•„ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                    </div>
                    
                    <button class="btn btn-blue" onclick="addPoint()">
                        <span>â•</span>
                        <span>ì¢Œí‘œ ì¶”ê°€</span>
                    </button>
                </div>
                
                <!-- ì»¨íŠ¸ë¡¤ ë²„íŠ¼ë“¤ -->
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <button id="showPointsBtn" class="btn btn-gray btn-full" onclick="toggleShowPoints()">
                        ê°’ í‘œì‹œí•˜ê¸°
                    </button>
                    
                    <button id="showTrendLineBtn" class="btn btn-disabled btn-full" onclick="toggleTrendLine()" disabled>
                        ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
                    </button>
                    
                    <button id="predictModeBtn" class="btn btn-disabled btn-full" onclick="togglePredictMode()" disabled>
                        ì›í•˜ëŠ” ê°’ êµ¬í•˜ê¸°
                    </button>
                </div>
                
                <!-- ì˜ˆì¸¡ ì…ë ¥ -->
                <div id="predictSection" class="predict-section hidden">
                    <h3 style="font-weight: 500; margin-bottom: 12px;">ê°’ ì˜ˆì¸¡</h3>
                    <div class="radio-group">
                        <label class="radio-item">
                            <input type="radio" name="predictType" value="x" checked>
                            X ê°’ìœ¼ë¡œ Y êµ¬í•˜ê¸°
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="predictType" value="y">
                            Y ê°’ìœ¼ë¡œ X êµ¬í•˜ê¸°
                        </label>
                    </div>
                    
                    <div class="predict-input-group">
                        <input type="number" id="predictInput" class="predict-input" placeholder="ê°’ ì…ë ¥">
                        <button class="btn btn-green" onclick="handlePredict()">ê³„ì‚°</button>
                    </div>
                    
                    <div id="predictResult" class="result-box hidden">
                        <!-- ì˜ˆì¸¡ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
            
            <!-- ê·¸ë˜í”„ ì„¹ì…˜ -->
            <div class="graph-section">
                <h2 style="margin-bottom: 1rem;">ê·¸ë˜í”„</h2>
                <div class="graph-container">
                    <div id="emptyGraph" class="empty-graph">
                        <div>
                            <p style="font-size: 1.125rem; margin-bottom: 8px;">ì¢Œí‘œë¥¼ ì…ë ¥í•˜ê³ </p>
                            <p style="font-size: 1.125rem;">[ê°’ í‘œì‹œí•˜ê¸°] ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</p>
                        </div>
                    </div>
                    <svg id="graph" class="svg-graph hidden" width="600" height="450">
                        <!-- ê·¸ë˜í”„ê°€ ì—¬ê¸°ì— ê·¸ë ¤ì§‘ë‹ˆë‹¤ -->
                    </svg>
                </div>
                
                <!-- ë²”ë¡€ -->
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-dot" style="background-color: #2563eb;"></div>
                        <span>ì…ë ¥ëœ ì </span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-line" style="background-color: #dc2626;"></div>
                        <span>ì¶”ì„¸ì„ </span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-dot" style="background-color: #16a34a;"></div>
                        <span>ì˜ˆì¸¡ ì </span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜ë“¤
        let points = [
            { id: 1, x: '', y: '' },
            { id: 2, x: '', y: '' },
            { id: 3, x: '', y: '' },
            { id: 4, x: '', y: '' },
            { id: 5, x: '', y: '' }
        ];
        let showPoints = false;
        let showTrendLine = false;
        let predictMode = false;
        let predictResult = null;

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            renderPointInputs();
        });

        // í¬ì¸íŠ¸ ì…ë ¥ í•„ë“œ ë Œë”ë§
        function renderPointInputs() {
            const container = document.getElementById('pointsContainer');
            container.innerHTML = '';
            
            points.forEach(point => {
                const div = document.createElement('div');
                div.className = 'point-input';
                div.innerHTML = `
                    <span class="point-number">#${point.id}</span>
                    <input type="number" placeholder="x" value="${point.x}" 
                           onchange="updatePoint(${point.id}, 'x', this.value)">
                    <span>,</span>
                    <input type="number" placeholder="y" value="${point.y}" 
                           onchange="updatePoint(${point.id}, 'y', this.value)">
                    ${points.length > 1 ? `<button class="delete-btn" onclick="removePoint(${point.id})">ğŸ—‘ï¸</button>` : ''}
                `;
                container.appendChild(div);
            });
        }

        // í¬ì¸íŠ¸ ì¶”ê°€
        function addPoint() {
            const newId = Math.max(...points.map(p => p.id)) + 1;
            points.push({ id: newId, x: '', y: '' });
            renderPointInputs();
        }

        // í¬ì¸íŠ¸ ì œê±°
        function removePoint(id) {
            if (points.length > 1) {
                points = points.filter(p => p.id !== id);
                renderPointInputs();
                updateGraph();
            }
        }

        // í¬ì¸íŠ¸ ê°’ ì—…ë°ì´íŠ¸
        function updatePoint(id, field, value) {
            const point = points.find(p => p.id === id);
            if (point) {
                point[field] = value;
                updateGraph();
            }
        }

        // ì˜ˆì‹œ ë°ì´í„° ë¡œë“œ
        function loadSampleData() {
            const sampleDataSets = [
                [
                    { id: 1, x: '1', y: '2' },
                    { id: 2, x: '2', y: '4' },
                    { id: 3, x: '3', y: '6' },
                    { id: 4, x: '4', y: '8' },
                    { id: 5, x: '5', y: '10' }
                ],
                [
                    { id: 1, x: '1', y: '1' },
                    { id: 2, x: '2', y: '4' },
                    { id: 3, x: '3', y: '9' },
                    { id: 4, x: '4', y: '16' },
                    { id: 5, x: '5', y: '25' }
                ],
                [
                    { id: 1, x: '20', y: '50' },
                    { id: 2, x: '25', y: '80' },
                    { id: 3, x: '30', y: '120' },
                    { id: 4, x: '35', y: '150' },
                    { id: 5, x: '40', y: '200' }
                ]
            ];
            
            const randomIndex = Math.floor(Math.random() * sampleDataSets.length);
            points = sampleDataSets[randomIndex];
            renderPointInputs();
            
            showPoints = true;
            predictMode = false;
            predictResult = null;
            updateButtons();
            updateGraph();
        }

        // ìœ íš¨í•œ í¬ì¸íŠ¸ë“¤ ê°€ì ¸ì˜¤ê¸°
        function getValidPoints() {
            return points
                .filter(p => p.x !== '' && p.y !== '' && !isNaN(p.x) && !isNaN(p.y))
                .map(p => ({ x: parseFloat(p.x), y: parseFloat(p.y) }));
        }

        // ì¶”ì„¸ì„  ê³„ì‚°
        function calculateTrendLine(validPoints) {
            if (validPoints.length < 2) return null;
            
            const n = validPoints.length;
            const sumX = validPoints.reduce((sum, p) => sum + p.x, 0);
            const sumY = validPoints.reduce((sum, p) => sum + p.y, 0);
            const sumXY = validPoints.reduce((sum, p) => sum + p.x * p.y, 0);
            const sumXX = validPoints.reduce((sum, p) => sum + p.x * p.x, 0);
            
            const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
            const intercept = (sumY - slope * sumX) / n;
            
            return { slope, intercept };
        }

        // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateButtons() {
            const showPointsBtn = document.getElementById('showPointsBtn');
            const showTrendLineBtn = document.getElementById('showTrendLineBtn');
            const predictModeBtn = document.getElementById('predictModeBtn');
            
            // ê°’ í‘œì‹œí•˜ê¸° ë²„íŠ¼
            if (showPoints) {
                showPointsBtn.className = 'btn btn-primary btn-full';
            } else {
                showPointsBtn.className = 'btn btn-gray btn-full';
            }
            
            // ê·¸ë˜í”„ ê·¸ë¦¬ê¸° ë²„íŠ¼
            if (!showPoints) {
                showTrendLineBtn.className = 'btn btn-disabled btn-full';
                showTrendLineBtn.disabled = true;
            } else {
                if (showTrendLine) {
                    showTrendLineBtn.className = 'btn btn-red btn-full';
                } else {
                    showTrendLineBtn.className = 'btn btn-gray btn-full';
                }
                showTrendLineBtn.disabled = false;
            }
            
            // ì›í•˜ëŠ” ê°’ êµ¬í•˜ê¸° ë²„íŠ¼
            if (!showPoints) {
                predictModeBtn.className = 'btn btn-disabled btn-full';
                predictModeBtn.disabled = true;
            } else {
                if (predictMode) {
                    predictModeBtn.className = 'btn btn-green btn-full';
                } else {
                    predictModeBtn.className = 'btn btn-gray btn-full';
                }
                predictModeBtn.disabled = false;
            }
        }

        // ê°’ í‘œì‹œí•˜ê¸° í† ê¸€
        function toggleShowPoints() {
            showPoints = !showPoints;
            if (!showPoints) {
                showTrendLine = false;
                predictResult = null;
            }
            updateButtons();
            updateGraph();
        }

        // ì¶”ì„¸ì„  í† ê¸€
        function toggleTrendLine() {
            const validPoints = getValidPoints();
            if (validPoints.length < 2) {
                alert('ì¶”ì„¸ì„ ì„ ê·¸ë¦¬ë ¤ë©´ ìµœì†Œ 2ê°œì˜ ìœ íš¨í•œ ì ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            showTrendLine = !showTrendLine;
            if (showTrendLine) {
                showPoints = true;
            }
            updateButtons();
            updateGraph();
        }

        // ì˜ˆì¸¡ ëª¨ë“œ í† ê¸€
        function togglePredictMode() {
            const validPoints = getValidPoints();
            if (validPoints.length < 2) {
                alert('ê°’ì„ ì˜ˆì¸¡í•˜ë ¤ë©´ ìµœì†Œ 2ê°œì˜ ìœ íš¨í•œ ì ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            predictMode = !predictMode;
            predictResult = null;
            
            const predictSection = document.getElementById('predictSection');
            const predictResultDiv = document.getElementById('predictResult');
            
            if (predictMode) {
                predictSection.classList.remove('hidden');
            } else {
                predictSection.classList.add('hidden');
            }
            predictResultDiv.classList.add('hidden');
            
            updateButtons();
            updateGraph();
        }

        // ì˜ˆì¸¡ ì²˜ë¦¬
        function handlePredict() {
            const validPoints = getValidPoints();
            if (validPoints.length < 2) {
                alert('ì¶”ì„¸ì„ ì„ ê·¸ë¦¬ë ¤ë©´ ìµœì†Œ 2ê°œì˜ ìœ íš¨í•œ ì ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }
            
            const predictInput = document.getElementById('predictInput');
            const inputValue = parseFloat(predictInput.value);
            if (isNaN(inputValue)) {
                alert('ìœ íš¨í•œ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const predictType = document.querySelector('input[name="predictType"]:checked').value;
            const trendLine = calculateTrendLine(validPoints);
            if (!trendLine) return;
            
            let result;
            if (predictType === 'x') {
                const y = trendLine.slope * inputValue + trendLine.intercept;
                result = { x: inputValue, y };
            } else {
                const x = (inputValue - trendLine.intercept) / trendLine.slope;
                result = { x, y: inputValue };
            }
            
            predictResult = result;
            showTrendLine = true;
            
            // ê²°ê³¼ í‘œì‹œ
            const predictResultDiv = document.getElementById('predictResult');
            const resultValue = predictType === 'x' ? result.y.toFixed(2) : result.x.toFixed(2);
            const resultLabel = predictType === 'x' ? 'Y' : 'X';
            
            predictResultDiv.innerHTML = `ì˜ˆì¸¡ ê²°ê³¼: ${resultLabel} = ${resultValue}`;
            predictResultDiv.classList.remove('hidden');
            
            updateButtons();
            updateGraph();
        }

        // ê·¸ë˜í”„ ì—…ë°ì´íŠ¸
        function updateGraph() {
            const validPoints = getValidPoints();
            const emptyGraph = document.getElementById('emptyGraph');
            const graph = document.getElementById('graph');
            
            if (validPoints.length === 0 || !showPoints) {
                emptyGraph.classList.remove('hidden');
                graph.classList.add('hidden');
                return;
            }
            
            emptyGraph.classList.add('hidden');
            graph.classList.remove('hidden');
            
            renderGraph(validPoints);
        }

        // SVG ê·¸ë˜í”„ ë Œë”ë§
        function renderGraph(validPoints) {
            const graph = document.getElementById('graph');
            
            // ì¢Œí‘œ ë²”ìœ„ ê³„ì‚°
            const xValues = validPoints.map(p => p.x);
            const yValues = validPoints.map(p => p.y);
            let minX = Math.min(...xValues);
            let maxX = Math.max(...xValues);
            let minY = Math.min(...yValues);
            let maxY = Math.max(...yValues);
            
            // ì˜ˆì¸¡ ê²°ê³¼ê°€ ìˆìœ¼ë©´ ë²”ìœ„ì— í¬í•¨
            if (predictResult) {
                minX = Math.min(minX, predictResult.x);
                maxX = Math.max(maxX, predictResult.x);
                minY = Math.min(minY, predictResult.y);
                maxY = Math.max(maxY, predictResult.y);
            }
            
            // ë²”ìœ„ì— ì—¬ë°± ì¶”ê°€
            const xRange = maxX - minX || 10;
            const yRange = maxY - minY || 10;
            const xPadding = xRange * 0.1;
            const yPadding = yRange * 0.1;
            
            minX -= xPadding;
            maxX += xPadding;
            minY -= yPadding;
            maxY += yPadding;
            
            const width = 600;
            const height = 450;
            const padding = 60;
            const graphWidth = width - 2 * padding;
            const graphHeight = height - 2 * padding;
            
            // ì¢Œí‘œ ë³€í™˜ í•¨ìˆ˜
            const toSvgX = (x) => padding + ((x - minX) / (maxX - minX)) * graphWidth;
            const toSvgY = (y) => height - padding - ((y - minY) / (maxY - minY)) * graphHeight;
            
            // SVG ë‚´ìš© ì´ˆê¸°í™”
            graph.innerHTML = '';
            
            // ê²©ìì„  ê·¸ë¦¬ê¸°
            const numGridLines = 10;
            for (let i = 0; i <= numGridLines; i++) {
                // ì„¸ë¡œ ê²©ìì„ 
                const x = padding + (i / numGridLines) * graphWidth;
                const vLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                vLine.setAttribute('x1', x);
                vLine.setAttribute('y1', padding);
                vLine.setAttribute('x2', x);
                vLine.setAttribute('y2', height - padding);
                vLine.setAttribute('stroke', '#e5e5e5');
                vLine.setAttribute('stroke-width', '1');
                graph.appendChild(vLine);
                
                // ê°€ë¡œ ê²©ìì„ 
                const y = padding + (i / numGridLines) * graphHeight;
                const hLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                hLine.setAttribute('x1', padding);
                hLine.setAttribute('y1', y);
                hLine.setAttribute('x2', width - padding);
                hLine.setAttribute('y2', y);
                hLine.setAttribute('stroke', '#e5e5e5');
                hLine.setAttribute('stroke-width', '1');
                graph.appendChild(hLine);
            }
            
            // ì¶• ê·¸ë¦¬ê¸°
            const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            yAxis.setAttribute('x1', padding);
            yAxis.setAttribute('y1', padding);
            yAxis.setAttribute('x2', padding);
            yAxis.setAttribute('y2', height - padding);
            yAxis.setAttribute('stroke', '#333');
            yAxis.setAttribute('stroke-width', '2');
            graph.appendChild(yAxis);
            
            const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            xAxis.setAttribute('x1', padding);
            xAxis.setAttribute('y1', height - padding);
            xAxis.setAttribute('x2', width - padding);
            xAxis.setAttribute('y2', height - padding);
            xAxis.setAttribute('stroke', '#333');
            xAxis.setAttribute('stroke-width', '2');
            graph.appendChild(xAxis);
            
            // ì¶• ë ˆì´ë¸”
            for (let i = 0; i <= 5; i++) {
                // Xì¶• ë ˆì´ë¸”
                const x = padding + (i / 5) * graphWidth;
                const value = minX + (i / 5) * (maxX - minX);
                const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                xLabel.setAttribute('x', x);
                xLabel.setAttribute('y', height - padding + 25);
                xLabel.setAttribute('text-anchor', 'middle');
                xLabel.setAttribute('font-size', '12');
                xLabel.setAttribute('fill', '#666');
                xLabel.textContent = value.toFixed(1);
                graph.appendChild(xLabel);
                
                // Yì¶• ë ˆì´ë¸”
                const y = height - padding - (i / 5) * graphHeight;
                const yValue = minY + (i / 5) * (maxY - minY);
                const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                yLabel.setAttribute('x', padding - 15);
                yLabel.setAttribute('y', y + 4);
                yLabel.setAttribute('text-anchor', 'end');
                yLabel.setAttribute('font-size', '12');
                yLabel.setAttribute('fill', '#666');
                yLabel.textContent = yValue.toFixed(1);
                graph.appendChild(yLabel);
            }
            
            // ì¶• ì œëª©
            const xTitle = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            xTitle.setAttribute('x', width / 2);
            xTitle.setAttribute('y', height - 10);
            xTitle.setAttribute('text-anchor', 'middle');
            xTitle.setAttribute('font-size', '14');
            xTitle.setAttribute('fill', '#333');
            xTitle.setAttribute('font-weight', 'bold');
            xTitle.textContent = 'X';
            graph.appendChild(xTitle);
            
            const yTitle = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            yTitle.setAttribute('x', 15);
            yTitle.setAttribute('y', height / 2);
            yTitle.setAttribute('text-anchor', 'middle');
            yTitle.setAttribute('font-size', '14');
            yTitle.setAttribute('fill', '#333');
            yTitle.setAttribute('font-weight', 'bold');
            yTitle.setAttribute('transform', `rotate(-90 15 ${height / 2})`);
            yTitle.textContent = 'Y';
            graph.appendChild(yTitle);
            
            // ì¶”ì„¸ì„  ê·¸ë¦¬ê¸°
            if (showTrendLine && validPoints.length >= 2) {
                const trendLine = calculateTrendLine(validPoints);
                if (trendLine) {
                    const startX = minX;
                    const endX = maxX;
                    const startY = trendLine.slope * startX + trendLine.intercept;
                    const endY = trendLine.slope * endX + trendLine.intercept;
                    
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', toSvgX(startX));
                    line.setAttribute('y1', toSvgY(startY));
                    line.setAttribute('x2', toSvgX(endX));
                    line.setAttribute('y2', toSvgY(endY));
                    line.setAttribute('stroke', '#dc2626');
                    line.setAttribute('stroke-width', '2');
                    graph.appendChild(line);
                    
                    // ë°©ì •ì‹ í‘œì‹œ
                    const equation = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    equation.setAttribute('x', padding + 10);
                    equation.setAttribute('y', padding + 20);
                    equation.setAttribute('font-size', '
